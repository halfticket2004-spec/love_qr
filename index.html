<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For My Love â¤ï¸</title>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
}

body{
  height:100vh;
  overflow:hidden;
  background:linear-gradient(135deg,#fbd3e9,#bb377d);
  font-family:Georgia, serif;
  color:white;
  text-align:center;
}

/* FLOWERS */
#effects{
  position:fixed;
  inset:0;
  pointer-events:none;
  overflow:hidden;
  z-index:0;
}

.flower{
  position:absolute;
  top:-10%;
  font-size:22px;
  animation: fall linear infinite;
}

@keyframes fall{
  to{ transform:translateY(110vh); }
}

/* MAIN APP */
.container{
  position:relative;
  z-index:2;
  padding:30px;
}

input{
  width:80%;
  padding:14px;
  font-size:20px;
  border:none;
  border-radius:12px;
  text-align:center;
}

button{
  padding:14px 36px;
  font-size:18px;
  border:none;
  border-radius:25px;
  background:white;
  color:#bb377d;
  margin-top:15px;
  cursor:pointer;
}
</style>
</head>

<body>

<!-- FLOWERS LAYER -->
<div id="effects"></div>

<!-- BACKGROUND MUSIC -->
<audio id="bgMusic" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_4b3b8c6e7d.mp3" type="audio/mpeg">
</audio>

<!-- FIRST SCREEN -->
<div class="container" id="app">
  <h1>yevaru ra nuvvu ğŸ‘€</h1>
  <br>
  <button onclick="startExperience()">Tap to start â¤ï¸</button>
  <br><br>

  <input id="answer" placeholder="Type here">
  <br>

  <button onclick="check()">Submit</button>
</div>

<script>
/* FLOWERS */
for(let i=0;i<25;i++){
  const f=document.createElement("div");
  f.className="flower";
  f.innerHTML="ğŸŒ¸";
  f.style.left=Math.random()*100+"vw";
  f.style.animationDuration=5+Math.random()*6+"s";
  document.getElementById("effects").appendChild(f);
}

/* MUSIC */
function startExperience(){
  const m=document.getElementById("bgMusic");
  m.volume=0.6;
  m.play().catch(()=>{});
}

/* ANSWER CHECK */
function check(){
  const v=document.getElementById("answer").value.trim().toLowerCase();
  if(v==="its me"){
    mazeGame();
  }else{
    document.getElementById("app").innerHTML=
      "<h2>yevaru nanna rey nuvvu..</h2><h2>vellipora nanna ğŸ˜¤</h2>";
  }
}

/* ================= MAZE GAME ================= */

function mazeGame(){
 document.getElementById("app").innerHTML=
 `<h2>Find him â¤ï¸</h2>
 <p>Every path inside failsâ€¦ love finds a way around</p>
 <div class="maze-wrap">
   <img src="IMG_20260129_180303.png">
   <canvas id="draw" class="maze-overlay" width="340" height="340"></canvas>
   <div class="girl">ğŸ‘©</div>
   <div class="boy">ğŸ‘¦</div>
 </div>`;

 const c=document.getElementById("draw");
 const ctx=c.getContext("2d");

 /* âœ… FIXED: missing variables */
 const girl = { x: 60, y: 260 };
 const boy  = { x: 260, y: 60 };

 let movedRight = false;
 let movedDown = false;
 let startedAtGirl = false;

 let drawing=false;

 c.addEventListener("pointerdown", e=>{
  drawing = true;
  movedRight = false;
  movedDown = false;

  const x = e.offsetX;
  const y = e.offsetY;

  startedAtGirl =
    Math.abs(x-girl.x) < 30 &&
    Math.abs(y-girl.y) < 30;

  ctx.beginPath();
  ctx.moveTo(x,y);
 });

 c.addEventListener("pointerup",()=>drawing=false);

 c.addEventListener("pointermove", e=>{
  if(!drawing || !startedAtGirl) return;

  const x = e.offsetX;
  const y = e.offsetY;

  ctx.strokeStyle="#ff69b4";
  ctx.lineWidth=3;
  ctx.lineTo(x,y);
  ctx.stroke();

  if(x > girl.x + 40) movedRight = true;
  if(y > girl.y + 40) movedDown = true;

  if(
    movedRight &&
    movedDown &&
    Math.abs(x-boy.x) < 30 &&
    Math.abs(y-boy.y) < 30
  ){
    drawing = false;
    setTimeout(mazeGifts, 500);
  }
 });
}

/* ============== MAZE GIFTS + LETTER ============== */

function mazeGifts(){
 document.getElementById("app").innerHTML=
 `<div class="gifts">
   <div class="gift" onclick="mazeLetter()">ğŸ</div>
   <div class="gift" onclick="mazeLetter()">ğŸ</div>
   <div class="gift" onclick="mazeLetter()">ğŸ</div>
   <div class="gift" onclick="mazeLetter()">ğŸ</div>
 </div>`;
}

function mazeLetter(){
 document.getElementById("app").innerHTML=
 `<div class="letter page">
   i promise you ğŸ’Œ<br><br>
   Even on the most chaotic and ordinary days,<br>
   Iâ€™ll find a way to make you smile ğŸ˜<br><br>
   Just the way you found your way in the game ğŸ’–
   <br><br>
   <button onclick="carGame()">Next ğŸš—</button>
 </div>`;
}

/* ================= CAR GAME ================= */

function carGame(){
 document.getElementById("app").innerHTML=
 `<h2>Survive 1 minute ğŸš—</h2>
 <canvas id="road" width="300" height="420"></canvas>
 <div class="controls">
  <button onclick="moveL()">â¬…ï¸</button>
  <button onclick="moveR()">â¡ï¸</button>
 </div>
 <p id="timer">Time: 60</p>`;

 const c=document.getElementById("road");
 const x=c.getContext("2d");
 let car={x:130,y:350},obs=[],start=Date.now();

 window.moveL=()=>{if(car.x>70) car.x-=40}
 window.moveR=()=>{if(car.x<230) car.x+=40}

 function loop(){
  x.clearRect(0,0,300,420);
  x.fillStyle="#444";x.fillRect(80,0,140,420);
  x.font="28px serif";x.fillText("ğŸš—",car.x,car.y);

  if(Math.random()<0.02)
    obs.push({x:90+Math.random()*120,y:-20});

  for(let o of obs){
    o.y+=2;x.fillText("ğŸš™",o.x,o.y);
    if(Math.abs(o.x-car.x)<18 && Math.abs(o.y-car.y)<18){
      carGame();
      return;
    }
  }
  obs=obs.filter(o=>o.y<450);

  let t=60-Math.floor((Date.now()-start)/1000);
  document.getElementById("timer").innerText="Time: "+t;
  if(t<=0){ carGifts(); return; }

  requestAnimationFrame(loop);
 }
 loop();
}

/* ============== CAR GIFTS + LETTER ============== */

function carGifts(){
 document.getElementById("app").innerHTML=
 `<div class="gifts">
   <div class="gift" onclick="carLetter()">ğŸ</div>
   <div class="gift" onclick="carLetter()">ğŸ</div>
   <div class="gift" onclick="carLetter()">ğŸ</div>
 </div>`;
}

function carLetter(){
 document.getElementById("app").innerHTML=
 `<div class="letter page">
   i promise you ğŸ’Œ<br><br>
   On gloomy and bad days,<br>
   I will reach you through all the hurdles<br>
   as fast as I can ğŸš—ğŸ’¨<br><br>
   just the way you did in the game ğŸ’–
   <br><br>
   <button onclick="finalPage()">Next ğŸ“–</button>
 </div>`;
}

/* ================= FINAL PAGE ================= */

function finalPage(){
 document.getElementById("app").innerHTML=
 `<div class="letter page">
   I promise you ğŸ«‚ğŸ’–<br><br>
   I will stay with you<br>
   until the last page of my book ğŸ“–<br><br>
   â¤ï¸
 </div>`;
}
</script>

</body>
</html>
